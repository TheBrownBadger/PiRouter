# Sample configuration for telegraf

#	Read vnStat Data
	[[inputs.exec]]
		commands = ["/usr/bin/vnstat --json"]
		timeout = "5s"
		data_format = "json"
		name_override = "vnstat"
		interval = "10s"

# Because we are using Influx 1.x we do not need this configuration.
  #[[inputs.vnstat]]
  ## Gather stats from wlan0
  #	interfaces = ["wlan1","wlan0"]
  #	binary = "/usr/bin/vnstat"
  #	Config for PiRouter
  #	[agent]
  #	interval = "30s"
  #	round_interval = true
  #	metric_batch_size = 1000
  #	flush_interval = "30s"
  #	hostname = "PiRouter"

	[[outputs.influxdb]]
		urls = ["http://localhost:8086"]
#  token = "YourInfluxTokenHere"
#  organization = "RouterOrg"
#  bucket = "router_metrics"
	 database = "telegraf"
	 username = "telegraf"
#  passsword = "telegraf"
	 precision = "s"
	 retention_policy = ""
	 write_consistency = "any"
	 timeout = "5s"
#	 username = "admin"
#	 password = "admin"
		
# CPU usage
	[[inputs.cpu]]
		percpu = true
		totalcpu = true
		collect_cpu_time = false
		report_active = true

# Memory usage
	[[inputs.mem]]
	
# Disk usage
	[[inputs.disk]]
		ignore_fs = ["tmpfs", "devtmpfs", "overlay"]

# Disk I/O
	[[inputs.diskio]]

# Network throughput
	[[inputs.net]]
		interfaces = ["wlan0"]

# TCP/UDP stats
	[[inputs.netstat]]

# System level metrics 
	[[inputs.system]]

# Number of running processes
	[[inputs.processes]]

# Pi specific CPU stats
	[[inputs.exec]]
		commands = ["/usr/bin/vcgencmd measure_temp"]
		name_override = "cpu_temperature"
		data_format = "grok"
		grok_patterns = ["%{GREEDYDATA:ignore} = %{NUMBER:temperature:float}'C"]
		interval = "30s"
		
# Wireless signal strength 
	[[inputs.exec]]
		commands = ["/home/pi/scripts/wifi_signal.sh"]
		timeout = "5s"
		name_override = "wifi_signal"
		data_format = "influx"
		interval = "30s"

# tcpdump summary
	[[inputs.exec]]
		commands = ["/home/pi/scripts/tcpdump_summary.sh"]
		name_override = "tcpdump_summary"
		data_format = "influx"
		interval = "60s"

# Additional script summaries
	[[inputs.exec]]
		commands = [
			"/home/pi/scripts/vnstat_summary.sh",
			"/home/pi/scripts/tcpdump_summary.sh",
			"/home/pi/scripts/top_bandwidth_users.sh",
			"/home/pi/scripts/wifi_clients.sh"
			]
		timeout = "10s"
		data_format = "influx"


